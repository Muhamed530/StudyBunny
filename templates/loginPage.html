<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chubby Bunny - Study Data Analysis</title>
    <link rel="stylesheet" href ="/static/css/base.css">
    <link rel="stylesheet" href="/static/css/loginPage.css">
    <script defer src="/static/js/loginPage.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class ="logo-container">
            <img src="/static/images/carrot.png" alt = "StudyBunny Logo" width="60" height="60">
            <span class = "logo-text">studybunny</span>
        </div>
        <ul class="nav-links">
            <li><a href="#">Why Us?</a></li>
            <li><a href="#">About</a></li>
            <li><a href="#">Plus</a></li>
            <li><a href="#">Login / Sign Up</a></li>
        </ul>
    </nav>
    <section>
        <div class = "form-box">
            <div class = "form-value">
                <h2>Paste Your Study Data (CSV)</h2>
                <form id="analyze-form">
                    <textarea id="studydata" name="studydata" rows="8" cols="50" placeholder="Paste your study data here (CSV format)"></textarea>
                    <br>
                    <button type="submit">Analyze</button>
                </form>
                <div id="recommendation" style="margin-top:20px;"></div>
            </div>
        </div>
    </section>
    <script>
    document.getElementById('analyze-form').addEventListener('submit', async function(e) {
        e.preventDefault();
        const studydata = document.getElementById('studydata').value;
        const recommendationDiv = document.getElementById('recommendation');
        recommendationDiv.textContent = 'Analyzing...';
        try {
            const response = await fetch('/analyze', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: new URLSearchParams({ studydata })
            });
            const result = await response.json();
            if (result.recommendation) {
                recommendationDiv.textContent = result.recommendation;
            } else if (result.error) {
                recommendationDiv.textContent = 'Error: ' + result.error;
            } else {
                recommendationDiv.textContent = 'Unexpected response.';
            }
        } catch (err) {
            recommendationDiv.textContent = 'Error: ' + err;
        }
    });
    </script>
</body>
</html>